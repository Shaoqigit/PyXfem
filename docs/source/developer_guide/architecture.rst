架构设计
========

本章节介绍PyAcoustiX的软件架构设计。

整体架构
--------

PyAcoustiX采用模块化设计，主要包含以下组件:

.. code-block:: text

   ┌─────────────────────────────────────────┐
   │           User Interface                │
   │  (CLI, Python API, Input Files)        │
   └─────────────────────────────────────────┘
                    ↓
   ┌─────────────────────────────────────────┐
   │         Interface Layer                 │
   │  (parser, sol_setup)                   │
   └─────────────────────────────────────────┘
                    ↓
   ┌─────────────────────────────────────────┐
   │           Core Modules                  │
   │  ┌─────────┐ ┌──────────┐ ┌─────────┐  │
   │  │  Mesh   │ │ Materials│ │PostProc │  │
   │  └─────────┘ └──────────┘ └─────────┘  │
   └─────────────────────────────────────────┘
                    ↓
   ┌─────────────────────────────────────────┐
   │           FEM Engine                    │
   │  ┌─────────┐ ┌──────────┐ ┌─────────┐  │
   │  │  Basis  │ │ Assembly │ │ Solver  │  │
   │  └─────────┘ └──────────┘ └─────────┘  │
   │  ┌─────────┐ ┌──────────┐ ┌─────────┐  │
   │  │DofHandler│ │BCsImpose │ │Quadrature│ │
   │  └─────────┘ └──────────┘ └─────────┘  │
   └─────────────────────────────────────────┘
                    ↓
   ┌─────────────────────────────────────────┐
   │       Advanced Features                 │
   │  ┌─────────┐ ┌──────────┐ ┌─────────┐  │
   │  │   TMM   │ │   MoR    │ │ Analytical│ │
   │  └─────────┘ └──────────┘ └─────────┘  │
   └─────────────────────────────────────────┘

模块职责
--------

SAcouS.Mesh
~~~~~~~~~~~

- 网格数据结构和操作
- 支持1D/2D/3D网格
- Gmsh文件读取
- 网格细化和可视化

SAcouS.Materials
~~~~~~~~~~~~~~~~

- 材料模型定义
- 流体、多孔、弹性材料
- JCA和Biot模型
- 频率相关材料属性

SAcouS.acxfem
~~~~~~~~~~~~~

- FEM核心实现
- 基函数 (Lagrange, Lobatto)
- 矩阵组装
- 线性/迭代求解器
- 边界条件处理

SAcouS.acxtmm
~~~~~~~~~~~~~

- 传递矩阵法实现
- 多层结构分析
- FEM-TMM耦合

SAcouS.acxmor
~~~~~~~~~~~~~

- 模态降阶实现
- 快速频率扫描
- 降阶基求解器

设计原则
--------

1. **模块化**: 每个模块职责单一，易于维护和扩展
2. **面向对象**: 使用类和继承组织代码
3. **类型注解**: 提高代码可读性和IDE支持
4. **文档完善**: 详细的docstrings和注释
5. **测试覆盖**: 每个功能都有对应的测试

扩展开发
--------

添加新材料
~~~~~~~~~~

1. 在 ``Materials.py`` 中继承 ``BaseMaterial``
2. 实现 ``set_frequency`` 方法
3. 添加材料属性计算
4. 更新 ``MaterialFactory``

添加新求解器
~~~~~~~~~~~~

1. 在 ``Solver.py`` 中继承 ``BaseSolver``
2. 实现 ``solve`` 方法
3. 添加求解器配置选项

添加新物理模型
~~~~~~~~~~~~~~

1. 在 ``PhysicAssembler.py`` 中创建新的Assembler类
2. 实现矩阵组装方法
3. 添加边界条件处理

代码风格
--------

- 遵循PEP 8规范
- 使用Google风格docstrings
- 变量名使用snake_case
- 类名使用CamelCase
- 常量使用UPPER_CASE
